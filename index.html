<!DOCTYPE HTML>
<HTML lang="kr">
<head>
    <meta charset="utf-8">
    <title>test12</title>
    <style>
        #mapwrap {
            position: relative;
            overflow: hidden;
        }

        .category,
        .category * {
            margin: 0;
            padding: 0;
            color: #000;
        }

        .category {
            position: absolute;
            overflow: hidden;
            top: 10px;
            left: 10px;
            width: 250px;
            height: 50px;
            z-index: 10;
            border: 1px solid black;
            font-family: 'Malgun Gothic', '맑은 고딕', sans-serif;
            font-size: 12px;
            text-align: center;
            background-color: #fff;
        }

        .category .menu_selected {
            background: #FF5F4A;
            color: #fff;
            border-left: 1px solid #915B2F;
            border-right: 1px solid #915B2F;
            margin: 0 -1px;
        }

        .category li {
            list-style: none;
            float: left;
            width: 60px;
            height: 45px;
            padding-top: 5px;
            cursor: pointer;
        }

        .category .ico_comm {
            display: block;
            margin: 0 auto 2px;
            width: 22px;
            height: 26px;
            background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/category.png') no-repeat;
        }

        .category .ico_coffee {
            background-position: -10px 0;
        }

        .category .ico_store {
            background-position: -10px -36px;
        }

        .category .ico_carpark {
            background-position: -10px -72px;
        }
        
        .category .ico_all {
            background-position: -10px -108px;
        }

        /* 추가된 스타일 */
        #toggleUI {
            position: absolute;
            bottom: 10px;
            left: 10px;
            z-index: 20;
            padding: 5px 10px;
            background-color: #fff;
            border: 1px solid #000;
            cursor: pointer;
        }

        /* 커스텀 오버레이 스타일 */
        .customoverlay {
            position: absolute;
            bottom: 10px;
            left: -150px;
            display: none;
            border: 1px solid #ccc;
            background-color: white;
            min-width: 300px;
            padding: 10px;
            font-size: 12px;
            text-align: left;
        }

        .overlay_close {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            z-index: 10;
        }

        /* 추가된 스타일: 커스텀 오버레이 내 이미지 스타일 */
        .customoverlay img {
            float: left;
            margin-right: 10px;
            max-width: 100px;
            height: auto;
        }
    </style>
</head>
<body>
<div id="map" style="width: 100%; height: 100% !important; padding-bottom: 50%; position: relative;"></div>

<!-- 지도 위에 표시될 마커 카테고리 -->
<div class="category">
    <ul>
        <li id="coffeeMenu" onclick="changeMarker('coffee')">
            <span class="ico_comm ico_coffee"></span>
            커피숍
        </li>
        <li id="storeMenu" onclick="changeMarker('store')">
            <span class="ico_comm ico_store"></span>
            편의점
        </li>
        <li id="carparkMenu" onclick="changeMarker('carpark')">
            <span class="ico_comm ico_carpark"></span>
            주차장
        </li>
        <li id="allMenu" onclick="changeMarker('all')">
            <span class="ico_comm ico_all"></span>
            모두
        </li>
    </ul>
</div>

<!-- 검색 폼 추가 -->
<div style="position: absolute; top: 70px; left: 10px; z-index: 10; background-color: white; padding: 10px; border: 1px solid black;">
    <form id="searchForm">
        <label for="latitude">위도: </label><input type="text" id="latitude" name="latitude" required><br>
        <label for="longitude">경도: </label><input type="text" id="longitude" name="longitude" required><br>
        <label for="category">카테고리: </label>
        <select id="category" name="category">
            <option value="coffee">커피숍</option>
            <option value="store">편의점</option>
            <option value="carpark">주차장</option>
        </select><br>
        <label for="info">추가 정보: </label><input type="text" id="info" name="info"><br>
        <button type="button" onclick="addMarker()">추가</button>
        <button type="button" onclick="moveToCoordinates()">위치로 이동</button>
        <button type="button" onclick="clearMarkers()">마커 초기화</button>
    </form>
</div>

<!-- UI 숨기기/보이기 버튼 -->
<div id="toggleUI" onclick="toggleUI()">UI 숨기기</div>

<!-- 커스텀 오버레이 -->
<div id="customOverlay" class="customoverlay">
    <div id="overlayContent">
        <div id="overlayClose" class="overlay_close" onclick="closeOverlay()">닫기</div>
        <div id="overlayInfo">
            <div id="markerNumber"></div>
            <div id="address"></div>
            <div id="rotation"></div>
            <div id="fixed"></div>
            <div id="description"></div>
            <div id="image"></div>
        </div>
    </div>
</div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=da010f91e59f856e4b8d54937ba756b6"></script>
<script>
    var mapContainer = document.getElementById('map'),
        mapOption = {
            center: new kakao.maps.LatLng(37.499590490909185, 127.0263723554437),
            level: 5
        };

    var map = new kakao.maps.Map(mapContainer, mapOption);

    var coffeePositions = [
        new kakao.maps.LatLng(37.499590490909185, 127.0263723554437),
        new kakao.maps.LatLng(37.499427948430814, 127.02794423197847),
        new kakao.maps.LatLng(37.498553760499505, 127.02882598822454),
        new kakao.maps.LatLng(37.497625593121384, 127.02935713582038),
        new kakao.maps.LatLng(37.49646391248451, 127.02675574250912),
        new kakao.maps.LatLng(37.49629291770947, 127.02587362608637),
        new kakao.maps.LatLng(37.49754540521486, 127.02546694890695)
    ];

    var coffeeInfo = [
        { number: "52-1", address: "부림동", rotation: "회전형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "110-1", address: "부림동", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "302-5", address: "부림동", rotation: "회전형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "505-2", address: "부림동", rotation: "고정형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "712-1", address: "부림동", rotation: "회전형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "800-3", address: "부림동", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "901-4", address: "부림동", rotation: "고정형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" }
    ];

    var storePositions = [
        new kakao.maps.LatLng(37.49693257325425, 127.02903888936508),
        new kakao.maps.LatLng(37.49567360686953, 127.02851474534906),
        new kakao.maps.LatLng(37.49568823427818, 127.02646539440902),
        new kakao.maps.LatLng(37.49728869719172, 127.0256732976695),
        new kakao.maps.LatLng(37.49810118961896, 127.0274510568175),
        new kakao.maps.LatLng(37.49935399377584, 127.02575882812252),
        new kakao.maps.LatLng(37.500329510504845, 127.02525172249936)
    ];

    var storeInfo = [
        { number: "12-1", address: "영동대로", rotation: "고정형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "23-4", address: "영동대로", rotation: "회전형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "35-2", address: "영동대로", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "42-5", address: "영동대로", rotation: "회전형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "53-1", address: "영동대로", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "60-3", address: "영동대로", rotation: "회전형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "71-2", address: "영동대로", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" }
    ];

    var carparkPositions = [
        new kakao.maps.LatLng(37.50030024010844, 127.02638129804548),
        new kakao.maps.LatLng(37.4990366669257, 127.02816655525269),
        new kakao.maps.LatLng(37.49728635486586, 127.02938659465664),
        new kakao.maps.LatLng(37.49645289789534, 127.02698867609304),
        new kakao.maps.LatLng(37.4972581687596, 127.02533761900772),
        new kakao.maps.LatLng(37.49882263016354, 127.02503403239852),
        new kakao.maps.LatLng(37.50025962161478, 127.02582960319708)
    ];

    var carparkInfo = [
        { number: "98-1", address: "자곡동", rotation: "고정형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "104-5", address: "자곡동", rotation: "회전형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "113-2", address: "자곡동", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "125-1", address: "자곡동", rotation: "회전형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "133-4", address: "자곡동", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "147-3", address: "자곡동", rotation: "회전형", fixed: "회전형", description: "상세설명", image: "https://via.placeholder.com/150" },
        { number: "151-2", address: "자곡동", rotation: "고정형", fixed: "고정형", description: "상세설명", image: "https://via.placeholder.com/150" }
    ];

    var markers = [];

    function displayMarkers(category) {
        // 기존 마커 삭제
        deleteMarkers();

        var positions;
        var infoWindow = new kakao.maps.InfoWindow({ zIndex: 1 });

        switch (category) {
            case 'coffee':
                positions = coffeePositions;
                info = coffeeInfo;
                break;
            case 'store':
                positions = storePositions;
                info = storeInfo;
                break;
            case 'carpark':
                positions = carparkPositions;
                info = carparkInfo;
                break;
            default:
                positions = coffeePositions.concat(storePositions, carparkPositions);
                info = coffeeInfo.concat(storeInfo, carparkInfo);
                break;
        }

        for (var i = 0; i < positions.length; i++) {
            var marker = addMarker(positions[i], info[i], category);
            markers.push(marker);
        }
    }

    function addMarker(position, info, category) {
        var markerImageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_';
        var markerImageSize = new kakao.maps.Size(24, 35);

        if (category === 'coffee') {
            markerImageSrc += 'coffee.png';
        } else if (category === 'store') {
            markerImageSrc += 'convenience.png';
        } else if (category === 'carpark') {
            markerImageSrc += 'car.png';
        } else {
            markerImageSrc += 'spot.png';
        }

        var markerImage = new kakao.maps.MarkerImage(markerImageSrc, markerImageSize);

        var marker = new kakao.maps.Marker({
            map: map,
            position: position,
            image: markerImage
        });

        kakao.maps.event.addListener(marker, 'click', function () {
            displayCustomOverlay(marker, info);
        });

        return marker;
    }

    function displayCustomOverlay(marker, info) {
        var overlay = document.getElementById('customOverlay');
        var overlayContent = document.getElementById('overlayContent');
        var imageContainer = document.getElementById('image');

        var img = new Image();
        img.src = info.image;
        imageContainer.innerHTML = '';
        imageContainer.appendChild(img);

        document.getElementById('markerNumber').innerHTML = '관리번호: ' + info.number;
        document.getElementById('address').innerHTML = '주소: ' + info.address;
        document.getElementById('rotation').innerHTML = '회전형: ' + info.rotation;
        document.getElementById('fixed').innerHTML = '고정형: ' + info.fixed;
        document.getElementById('description').innerHTML = '상세내용: ' + info.description;

        overlay.style.display = 'block';

        overlay.style.left = marker.getPosition().getLng() + 'px';
        overlay.style.top = marker.getPosition().getLat() + 'px';

        var overlayClose = document.getElementById('overlayClose');
        overlayClose.onclick = function () {
            overlay.style.display = 'none';
            return false;
        };
    }

    function deleteMarkers() {
        for (var i = 0; i < markers.length; i++) {
            markers[i].setMap(null);
        }
        markers = [];
    }

</script>

</body>
</html>
