<!DOCTYPE HTML>
<HTML lang="kr">
<head>
    <meta charset="utf-8">
    <title>test7</title>
    <style>
        #mapwrap {
            position: relative;
            overflow: hidden;
        }

        .category,
        .category * {
            margin: 0;
            padding: 0;
            color: #000;
        }

        .category {
            position: absolute;
            overflow: hidden;
            top: 10px;
            left: 10px;
            width: 250px;
            height: 50px;
            z-index: 10;
            border: 1px solid black;
            font-family: 'Malgun Gothic', '맑은 고딕', sans-serif;
            font-size: 12px;
            text-align: center;
            background-color: #fff;
        }

        .category .menu_selected {
            background: #FF5F4A;
            color: #fff;
            border-left: 1px solid #915B2F;
            border-right: 1px solid #915B2F;
            margin: 0 -1px;
        }

        .category li {
            list-style: none;
            float: left;
            width: 60px;
            height: 45px;
            padding-top: 5px;
            cursor: pointer;
        }

        .category .ico_comm {
            display: block;
            margin: 0 auto 2px;
            width: 22px;
            height: 26px;
            background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/category.png') no-repeat;
        }

        .category .ico_coffee {
            background-position: -10px 0;
        }

        .category .ico_store {
            background-position: -10px -36px;
        }

        .category .ico_carpark {
            background-position: -10px -72px;
        }
        
        .category .ico_all {
            background-position: -10px -108px;
        }

        /* 추가된 스타일 */
        #toggleUI {
            position: absolute;
            bottom: 10px;
            left: 10px;
            z-index: 20;
            padding: 5px 10px;
            background-color: #fff;
            border: 1px solid #000;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div id="map" style="width: 100%; height: 100% !important; padding-bottom: 50%; position: relative;"></div>

<!-- 지도 위에 표시될 마커 카테고리 -->
<div class="category">
    <ul>
        <li id="coffeeMenu" onclick="changeMarker('coffee')">
            <span class="ico_comm ico_coffee"></span>
            커피숍
        </li>
        <li id="storeMenu" onclick="changeMarker('store')">
            <span class="ico_comm ico_store"></span>
            편의점
        </li>
        <li id="carparkMenu" onclick="changeMarker('carpark')">
            <span class="ico_comm ico_carpark"></span>
            주차장
        </li>
        <li id="allMenu" onclick="changeMarker('all')">
            <span class="ico_comm ico_all"></span>
            모두
        </li>
    </ul>
</div>

<!-- 검색 폼 추가 -->
<div style="position: absolute; top: 70px; left: 10px; z-index: 10; background-color: white; padding: 10px; border: 1px solid black;">
    <form id="searchForm">
        <label for="latitude">위도: </label><input type="text" id="latitude" name="latitude" required><br>
        <label for="longitude">경도: </label><input type="text" id="longitude" name="longitude" required><br>
        <label for="category">카테고리: </label>
        <select id="category" name="category">
            <option value="coffee">커피숍</option>
            <option value="store">편의점</option>
            <option value="carpark">주차장</option>
        </select><br>
        <label for="info">추가 정보: </label><input type="text" id="info" name="info"><br>
        <button type="button" onclick="addMarker()">추가</button>
        <button type="button" onclick="removeMarker()">삭제</button>
    </form>
</div>

<!-- UI 숨기기/보이기 버튼 -->
<div id="toggleUI" onclick="toggleUI()">UI 숨기기</div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=da010f91e59f856e4b8d54937ba756b6"></script>
<script>
    var mapContainer = document.getElementById('map'),
        mapOption = {
            center: new kakao.maps.LatLng(37.499590490909185, 127.0263723554437),
            level: 5
        };

    var map = new kakao.maps.Map(mapContainer, mapOption);

    var coffeePositions = [
        new kakao.maps.LatLng(37.499590490909185, 127.0263723554437),
        new kakao.maps.LatLng(37.499427948430814, 127.02794423197847),
        new kakao.maps.LatLng(37.498553760499505, 127.02882598822454),
        new kakao.maps.LatLng(37.497625593121384, 127.02935713582038),
        new kakao.maps.LatLng(37.49646391248451, 127.02675574250912),
        new kakao.maps.LatLng(37.49629291770947, 127.02587362608637),
        new kakao.maps.LatLng(37.49754540521486, 127.02546694890695)
    ];

    var coffeeInfo = [
        "부림동 52-1",
        "부림동 110-1",
        "부림동 140-1",
        "부림동 120-1",
        "부림동 122-221",
        "부림동 540-1",
        "부림동 1340-1"
    ];

    var storePositions = [
        new kakao.maps.LatLng(37.497535461505684, 127.02948149502778),
        new kakao.maps.LatLng(37.49671536281186, 127.03020491448352),
        new kakao.maps.LatLng(37.496201943633714, 127.02959405469642),
        new kakao.maps.LatLng(37.49640072567703, 127.02726459882308),
        new kakao.maps.LatLng(37.49640098874988, 127.02609983175294),
        new kakao.maps.LatLng(37.49932849491523, 127.02935780247945),
        new kakao.maps.LatLng(37.49996818951873, 127.02943721562295)
    ];

    var storeInfo = [
        "중앙동 52-1",
        "과천동 110-1",
        "중앙동 140-1",
        "과천동 120-1",
        "과천동 122-221",
        "과천동 540-1",
        "과천동 1340-1"
    ];

    var carparkPositions = [
        new kakao.maps.LatLng(37.49966168796031, 127.03007039430118),
        new kakao.maps.LatLng(37.499463762912974, 127.0288828824399),
        new kakao.maps.LatLng(37.49896834100913, 127.02833986892401),
        new kakao.maps.LatLng(37.49893267508434, 127.02673400572665),
        new kakao.maps.LatLng(37.49872543597439, 127.02676785815386),
        new kakao.maps.LatLng(37.49813096097184, 127.02591949495914),
        new kakao.maps.LatLng(37.497680616783086, 127.02518427952202)
    ];

    var carparkInfo = [
        "문원동 52-1",
        "문원동산 110-1",
        "혜화역 140-1",
        "과천Ic 120-1",
        "부천 122-221",
        "부산 540-1",
        "우편번호 1340-1"
    ];

    var markerImageSrc = '//t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커 이미지의 주소입니다
        markerImageSize = new kakao.maps.Size(30, 45), // 마커 이미지의 크기입니다
        markerImageOption = {offset: new kakao.maps.Point(15, 45)};

    var coffeeMarkers = [], storeMarkers = [], carparkMarkers = [];
    var addedMarkers = [], addedInfowindows = [];

    // 커피숍 마커와 인포윈도우를 생성하는 함수
    function makeCoffeeMarkers() {
        for (var i = 0; i < coffeePositions.length; i++) {
            var marker = new kakao.maps.Marker({
                position: coffeePositions[i],
                image: new kakao.maps.MarkerImage(markerImageSrc, markerImageSize, markerImageOption)
            });

            var infowindow = new kakao.maps.InfoWindow({
                content: '<div style="padding:5px;">' + coffeeInfo[i] + '</div>'
            });

            coffeeMarkers.push(marker);
            addedMarkers.push(marker);
            addedInfowindows.push(infowindow);

            // 마커를 지도에 표시합니다
            marker.setMap(map);

            // 마커에 클릭 이벤트를 등록합니다
            kakao.maps.event.addListener(marker, 'click', function () {
                infowindow.open(map, marker);
            });
        }
    }

    // 편의점 마커와 인포윈도우를 생성하는 함수
    function makeStoreMarkers() {
        for (var i = 0; i < storePositions.length; i++) {
            var marker = new kakao.maps.Marker({
                position: storePositions[i],
                image: new kakao.maps.MarkerImage(markerImageSrc, markerImageSize, markerImageOption)
            });

            var infowindow = new kakao.maps.InfoWindow({
                content: '<div style="padding:5px;">' + storeInfo[i] + '</div>'
            });

            storeMarkers.push(marker);
            addedMarkers.push(marker);
            addedInfowindows.push(infowindow);

            // 마커를 지도에 표시합니다
            marker.setMap(map);

            // 마커에 클릭 이벤트를 등록합니다
            kakao.maps.event.addListener(marker, 'click', function () {
                infowindow.open(map, marker);
            });
        }
    }

    // 주차장 마커와 인포윈도우를 생성하는 함수
    function makeCarparkMarkers() {
        for (var i = 0; i < carparkPositions.length; i++) {
            var marker = new kakao.maps.Marker({
                position: carparkPositions[i],
                image: new kakao.maps.MarkerImage(markerImageSrc, markerImageSize, markerImageOption)
            });

            var infowindow = new kakao.maps.InfoWindow({
                content: '<div style="padding:5px;">' + carparkInfo[i] + '</div>'
            });

            carparkMarkers.push(marker);
            addedMarkers.push(marker);
            addedInfowindows.push(infowindow);

            // 마커를 지도에 표시합니다
            marker.setMap(map);

            // 마커에 클릭 이벤트를 등록합니다
            kakao.maps.event.addListener(marker, 'click', function () {
                infowindow.open(map, marker);
            });
        }
    }

    // 초기화 함수: 지도에 모든 마커를 표시
    function initMap() {
        makeCoffeeMarkers();
        makeStoreMarkers();
        makeCarparkMarkers();
    }

    // 카테고리에 따라 마커를 변경하는 함수
    function changeMarker(category) {
        // 모든 마커를 지도에서 제거
        removeMarker();

        // 카테고리에 따라 해당 마커만 지도에 표시
        switch (category) {
            case 'coffee':
                coffeeMarkers.forEach(function (marker) {
                    marker.setMap(map);
                    addedMarkers.push(marker);
                });
                break;
            case 'store':
                storeMarkers.forEach(function (marker) {
                    marker.setMap(map);
                    addedMarkers.push(marker);
                });
                break;
            case 'carpark':
                carparkMarkers.forEach(function (marker) {
                    marker.setMap(map);
                    addedMarkers.push(marker);
                });
                break;
            case 'all':
                coffeeMarkers.forEach(function (marker) {
                    marker.setMap(map);
                    addedMarkers.push(marker);
                });
                storeMarkers.forEach(function (marker) {
                    marker.setMap(map);
                    addedMarkers.push(marker);
                });
                carparkMarkers.forEach(function (marker) {
                    marker.setMap(map);
                    addedMarkers.push(marker);
                });
                break;
            default:
                break;
        }
    }

    // 마커와 인포윈도우를 모두 제거하는 함수
    function removeMarker() {
        // 추가된 모든 마커와 인포윈도우를 제거합니다.
        addedMarkers.forEach(function (marker) {
            marker.setMap(null);
        });
        addedInfowindows.forEach(function (infowindow) {
            infowindow.close();
        });

        // 배열 초기화
        addedMarkers = [];
        addedInfowindows = [];
    }

    // UI 숨기기/보이기 함수
    function toggleUI() {
        var category = document.querySelector('.category');
        if (category.style.display === 'none') {
            category.style.display = 'block';
            document.getElementById('toggleUI').innerText = 'UI 숨기기';
        } else {
            category.style.display = 'none';
            document.getElementById('toggleUI').innerText = 'UI 보이기';
        }
    }

    // 초기화 함수 호출
    initMap();
</script>
</body>
</html>
